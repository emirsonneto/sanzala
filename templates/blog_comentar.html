{% extends "base.html" %}

{% block css %}
<link rel="stylesheet" href="{{ url_for('static', filename='blog.css') }}">
{% endblock %}

{% block content %}
<div class="container my-5">

  <!-- Post destacado -->
  <div class="post-card position-relative mb-5">
    <small class="position-absolute top-0 end-0 mt-2 me-3 text-muted" style="font-size: 0.75rem;">
      {{ post.data_criacao.strftime('%d/%m/%Y %H:%M') }}
    </small>

    <h2 class="d-flex align-items-center gap-2 mb-3">
      <span style="font-size: 1.5rem;">{{ post.icone }}</span> {{ post.titulo }}
    </h2>

    <p class="mb-4">{{ post.conteudo }}</p>

    <div class="d-flex align-items-center mt-3">
      <img src="{{ post.autor.avatar }}" class="user-avatar me-2" alt="avatar">
      <span class="text-light">{{ post.autor.nome }}</span>
    </div>
  </div>

  <!-- Comentários -->
  <div class="mb-4">
    <h4 class="text-success mb-3"><i class="far fa-comments me-2"></i> Comentários</h4>

    {% if post.comentarios %}
      {% for comentario in post.comentarios %}
        <div class="bg-dark p-3 rounded shadow-sm border-start border-4 border-success mb-4" style="box-shadow: 0 0 8px #00ffae33;">
          <div class="d-flex align-items-center mb-2">
            <img src="{{ comentario.autor.avatar }}" class="user-avatar me-2" alt="avatar">
            <div>
              <strong class="text-light">{{ comentario.autor.nome }}</strong><br>
              <small class="text-muted"><i class="fas fa-clock me-1"></i>{{ comentario.data_criacao.strftime('%d/%m/%Y %H:%M') }}</small>
            </div>
          </div>
          <div class="bg-black bg-opacity-50 text-light p-2 rounded mt-2" style="font-size: 0.95rem;">
            {{ comentario.conteudo }}
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p class="text-muted">Nenhum comentário ainda. Seja o primeiro!</p>
    {% endif %}
  </div>

  <!-- Formulário de comentário -->
  <form method="POST" class="form-postagem mt-4">
    {{ form.hidden_tag() }}

    <div class="mb-3">
      {{ form.conteudo.label(class="form-label text-light") }}
      {{ form.conteudo(class="form-control", rows=3, placeholder="Compartilhe sua visão...") }}
      {% for erro in form.conteudo.errors %}
        <div class="text-danger">{{ erro }}</div>
      {% endfor %}
    </div>

    <button type="submit" class="btn btn-postar w-100">
      <i class="fas fa-paper-plane me-1"></i> Enviar Comentário
    </button>
  </form>

</div>
{% endblock %}
